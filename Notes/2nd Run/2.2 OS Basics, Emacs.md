# Comprehensive Lecture Notes: Systems Tools and Concepts

## Table of Contents

1. Introduction  
2. Overview of Core Topics  
   2.1 Scripting and the Shell  
   2.2 IDEs: Emacs  
   2.3 File Systems (Linux-based)
3. Emacs  
   3.1 Background and Philosophy  
   3.2 Key Concepts  
       3.2.1 Buffers and Files  
       3.2.2 Persistence and Performance  
       3.2.3 Saving Mechanism  
       3.2.4 Modes in Emacs  
       3.2.5 Windows and Frames  
       3.2.6 Directory Editing (Dired Mode)  
   3.3 Shell Access Inside Emacs  
   3.4 Emacs Save Files and Metadata  
4. Shell and Command Line Tools  
   4.1 The Shell Environment  
   4.2 Terminal Commands Explored  
       4.2.1 cat  
       4.2.2 Control Characters (e.g., Ctrl+D, Ctrl+C, Ctrl+G)  
   4.3 Process Management with ps  
5. File System Concepts  
   5.1 Files, Buffers, and Caching  
   5.2 File Metadata and Permissions  
       5.2.1 File Types  
       5.2.2 Permission Bits  
       5.2.3 Extended Permission Bits  
       5.2.4 Ownership and Groups  
   5.3 Hard and Symbolic Links  
       5.3.1 Inode Numbers  
       5.3.2 Link Counts and Their Significance  
   5.4 Directories and Hierarchical Structure  
       5.4.1 The File Tree  
       5.4.2 The `.` and `..` Conventions  
       5.4.3 Relationship Between Link Counts and Directory Contents  
       5.4.4 Root Directory Special Case  
6. Summary

---

## 1. Introduction

In modern software development, users often deal with a triad of interrelated systems: scripting environments (such as shells), Integrated Development Environments (IDEs) like Emacs, and file systems (e.g., Linux file systems). This lecture takes a holistic, realistic approach to learning these tools simultaneously to mirror real-world development environments. Instead of isolating topics, systems are introduced in the overlapping, interdependent way in which they were historically developed and are actually used.

---

## 2. Overview of Core Topics

### 2.1 Scripting and the Shell

- Refers to automation and interaction through command-line interfaces (e.g., sh, bash).
- Used to manipulate files, manage processes, and interface with the operating system.
  
### 2.2 Integrated Development Environments: Emacs

- Emacs serves as a programmable text editor and IDE.
- Supports building custom environments for specific development needs.
- Integrates editing capabilities, file system browsing, and shell access.

### 2.3 File Systems (Linux-Based)

- Linux file systems organize data as a hierarchy of directories and files.
- Includes advanced features like symbolic links, hard links, permission metadata, and persistent storage.

---

## 3. Emacs

### 3.1 Background and Philosophy

- Originally a Vim user, the speaker adopted Emacs for its extensibility and suitability for building full IDEs.
- Emacs has a built-in programming language (Emacs Lisp), enabling high programmability and integration.
- Historically, Emacs enabled rapid development of software environments.

### 3.2 Key Concepts

#### 3.2.1 Buffers and Files

- A buffer is an in-memory representation of file contents.
  
| Concept | Description |
|--------|-------------|
| Buffer | A temporary in-memory area for content editing. Not persistent by default. |
| File   | On-disk storage with persistent data. |

- Emacs can show buffer-file associations, but editing a buffer does not immediately update the file.

Definition – Persistence: The capability for data (e.g., program state) to survive application exit or system crash.

#### 3.2.2 Persistence and Performance Trade-Off

- Naively making variables 'persistent' causes performance issues due to disk latency.
- Emacs addresses this with buffer-cache separation.

Example:
```cpp
persistent int numberOfStudents;
numberOfStudents++;
```
Would require saving to durable storage at every write, which is slow (milliseconds rather than nanoseconds).

#### 3.2.3 Saving Mechanism

- Emacs-style file saving:
    - `Ctrl+X Ctrl+S`: Explicit save to file.
    - Auto-save generates a file named like `#filename#`.
    - Emacs uses an internal temporary file and only writes to the original file on save.

Example:
```sh
# Scratch buffer not saved
Emacs opens buffer "hello.txt"
User edits -> changes only in buffer
Ctrl+X Ctrl+S -> content written to disk
```

#### 3.2.4 Modes in Emacs

Definition – Mode: The internal state dictating behavior in Emacs buffers.

- Emacs is "modeful"—behaviors change based on buffer modes.
  
| Mode       | Behavior                          |
|------------|-----------------------------------|
| Text Mode  | Standard editing                  |
| Dired Mode | Interacts with file directories   |

Example: Pressing "d" in text mode inserts 'd'; in Dired mode, it marks file for deletion.

#### 3.2.5 Windows and Frames

- Window: A viewport into a buffer within a frame.
- Frame: A full Emacs window as the OS sees it.
- Multiple windows can show different buffers side-by-side.

Command Summary:

| Command         | Action                        |
|-----------------|-------------------------------|
| Ctrl+X 4 D      | Open Dired in new window      |
| Ctrl+X O        | Move between windows          |
| Ctrl+X 1        | Focus single window           |

#### 3.2.6 Directory Editing (Dired Mode)

Definition – Directory: A file storing mappings to other files (file names → inodes).

- Dired allows manipulation (delete, rename) of files via an edited view of a directory.
- Commands:
    - `d`: Mark for deletion
    - `x`: Execute deletions
    - `?`: Show key options
    - `Ctrl+G`: Cancel pending command

---

### 3.3 Shell Access Inside Emacs

- `M-x shell`: Opens a shell inside Emacs.
- Basic commands:
    - `cat file`: Print contents
    - `ls -l`: List files with metadata
    - `Ctrl+D`: End-of-input
    - `Ctrl+C`: Interrupt
    - `Ctrl+G`: Cancel Emacs command

---

### 3.4 Emacs Save Files and Metadata

Emacs creates temporary metadata files for buffers:

1. `#filename#`: Regular auto-save file.
2. `.filename~`: Backup file (not discussed in detail).
3. `.filename.swp`: May appear in other editors (not Emacs).
4. `.filename` symlink:
    - Contains editor and session metadata:
        - Username
        - Hostname
        - Emacs process ID
        - System boot timestamp
    - Enables Emacs to warn if a file is open elsewhere.

Example:

```sh
ls -l
#hello.txt#    # Auto-save buffer
.hello.txt     # Symbolic link containing editing info
hello.txt      # Main file
```

---

## 4. Shell and Command Line Tools

### 4.1 The Shell Environment

Definition – Shell: A command interpreter for user interaction with the OS.

- Examples: bash, sh
- Default shells provide process management, file commands, and scripting features.

### 4.2 Terminal Commands

#### 4.2.1 cat

- `cat file`: Outputs content of a file.
- `cat`: With no args, reads from keyboard and echoes input.

#### 4.2.2 Control Characters

| Key           | Meaning                        |
|---------------|--------------------------------|
| Ctrl+D        | End-of-file/input              |
| Ctrl+C        | Interrupt (stop process)       |
| Ctrl+G        | Emacs interrupt (abort command)|
| Ctrl+@ / Ctrl+Space | Set mark for copy        |
| Meta+W        | Copy region (kill-ring)        |
| Ctrl+Y        | Paste ("yank")                 |

---

### 4.3 Process Management with ps

- `ps -ef`: List all current processes.
- Includes usernames, PIDs (Process IDs), and more.
- Usage: Identify editing Emacs pid to match with symlink metadata.

---

## 5. File System Concepts

### 5.1 Files, Buffers, and Caching

Definition – Buffer: In-memory cache of a file's contents.

- Advantages: Fast access, minimal I/O bottlenecks.
- This delay in syncing file contents is a performance feature, not a bug.

Emacs Optimization:
- Writes buffer on demand (Ctrl+X Ctrl+S)
- Auto-saves periodically to `#filename#`

---

### 5.2 File Metadata and Permissions

#### 5.2.1 File Types

| Symbol | Type             |
|--------|------------------|
| -      | Regular file      |
| d      | Directory         |
| l      | Symbolic link     |

#### 5.2.2 Permissions

- Nine-bit mask:
  - Three groups: user (owner), group, others.
  - Each has read (r), write (w), execute (x).

Binary to Symbolic Example:

| Octal | Symbolic |
|-------|----------|
| 7     | rwx      |
| 5     | r-x      |
| 4     | r--      |

Command:
```sh
chmod 754 file
```

#### 5.2.3 Extended Permission Bits (3 More)

| Bit        | Meaning                                                  |
|------------|----------------------------------------------------------|
| Sticky Bit | Restrict deletion in a directory. Marked with 't'        |
| Set UID    | Run executable as file's owner. Marked with 's' in user position |
| Set GID    | Run group as file’s group. Marked with 's' in group position |

Check with:
```sh
ls -l /tmp  # t on directory
ls -l /bin/su  # s on user or group
```

#### 5.2.4 Ownership and Groups

- Use `id` command to check current user and group.
- Each file has an owner and a group field.

---

### 5.3 Hard and Symbolic Links

#### 5.3.1 Hard Links

- Created using:
```sh
ln original newname
```
- Shares inode number and increases link count.

Observation:
- Link count > 1 means hard links exist.

Check:
```sh
ls -li
```

| Aspect        | Hard Link                           |
|---------------|-------------------------------------|
| Same inode?   | Yes                                 |
| Deletion Safe?| Content kept until link count = 0   |

#### 5.3.2 Symbolic Links

- Created using:
```sh
ln -s target linkname
```

- Stores pathname, often used across directories.
- Can be dangling (target doesn’t exist).

Used by Emacs with metadata to store process ID, editor, and system state in symlink name.

---

### 5.4 Directories and Hierarchical Structure

#### 5.4.1 The File Tree

- Filesystem structured as a rooted tree.
- Directories map filenames to inodes.
- Tools like `ls` show contents; `ls -l`, `ls -a`, `ls -i`, etc.

#### 5.4.2 Special Directory Symbols

| Symbol | Meaning          |
|--------|------------------|
| `.`    | Current directory|
| `..`   | Parent directory |

#### 5.4.3 Link Counts

- Directories start with link count = 2:
  - One for itself (`.`)
  - One from parent (`dirname`)
- Each subdirectory adds 1 to parent’s link count (from its `..`)

Example:
```sh
mkdir x
ls -ld x   # link count = 2
mkdir x/y
ls -ld x   # link count = 3
```

#### 5.4.4 Root Directory Exception

- `..` from `/` (root) points to itself.
- Root has link count matching number of subdirectories + 1.

---

## 6. Summary

This lecture introduced three core interconnected systems in a Unix/Linux environment: scripting via shell, file systems, and editing environments like Emacs. Emphasis was placed on realism through simultaneous learning and usage reflective of real-world software engineering scenarios. Emacs was covered in depth with its concept of buffers, windows, modes, saving mechanics, and integration with directories and the shell. File system fundamentals such as inode numbers, link counts, file permissions, symbolic vs hard links, and hierarchical structure were explored. Command-line utilities like `cat`, `ls`, `chmod`, `ps`, and `ln` helped demonstrate these principles. The engineer's need to balance persistence, performance, and understandability in system architecture was repeatedly highlighted.